Select * into Funcionario222 From dbo.DimEmployee

Select 
 EMPLOYEEKEY
,DEPARTMENTNAME
,FIRSTNAME
,LASTNAME
,MIDDLENAME
,STARTDATE
,ENDDATE
,GENDER
,GETDATE() DATA_HOJE
,CONCAT(FIRSTNAME,' ',MIDDLENAME,' ',LASTNAME) NOME_COMPLETO
,CASE WHEN ENDDATE IS NULL THEN 'ATIVO' ELSE 'DEMITIDO' END STATUS_FUNCIONARIO
,DATEDIFF(YEAR,STARTDATE,ENDDATE)   ANOS_DIF
,DATEDIFF(MONTH,STARTDATE,ENDDATE)  MES_DIF
,DATEDIFF(DAY,STARTDATE,ENDDATE)    DAY_DIF
,DATEDIFF(HOUR,STARTDATE,ENDDATE)   HORAS_DIF
,DATEDIFF(MINUTE,STARTDATE,ENDDATE) MINUTOS_DIF
,DATEDIFF(SECOND,STARTDATE,ENDDATE) SECOND_DIF



From  dbo.Funcionario222 
ORDER BY Status_Funcionario DESC




---------------------------------------------------------------

UPDATE dbo.Funcionario222
SET MiddleName = 'R'
WHERE MiddleName IS NULL



SELECT 
    EMPLOYEEKEY,
    DEPARTMENTNAME,
    FIRSTNAME,
    LASTNAME,
    MIDDLENAME,
    STARTDATE,
    ENDDATE,
    GENDER,
    GETDATE() AS DATA_HOJE,
    CONCAT(FIRSTNAME, ' ', MIDDLENAME, ' ', LASTNAME) AS NOME_COMPLETO,
    CASE WHEN ENDDATE IS NULL THEN 'ATIVO' ELSE 'DEMITIDO' END AS STATUS_FUNCIONARIO,
    CASE WHEN ENDDATE IS NULL THEN DATEDIFF(YEAR, STARTDATE, GETDATE()) ELSE DATEDIFF(YEAR, STARTDATE, ENDDATE) END AS ANOS_DIF,
    CASE WHEN ENDDATE IS NULL THEN DATEDIFF(MONTH, STARTDATE, GETDATE()) ELSE DATEDIFF(MONTH, STARTDATE, ENDDATE) END AS MES_DIF,
    CASE WHEN ENDDATE IS NULL THEN DATEDIFF(DAY, STARTDATE, GETDATE()) ELSE DATEDIFF(DAY, STARTDATE, ENDDATE) END AS DAY_DIF,
    CASE WHEN ENDDATE IS NULL THEN DATEDIFF(HOUR, STARTDATE, GETDATE()) ELSE DATEDIFF(HOUR, STARTDATE, ENDDATE) END AS HORAS_DIF,
    CASE WHEN ENDDATE IS NULL THEN DATEDIFF(MINUTE, STARTDATE, GETDATE()) ELSE DATEDIFF(MINUTE, STARTDATE, ENDDATE) END AS MINUTOS_DIF,
    CASE WHEN ENDDATE IS NULL THEN DATEDIFF(SECOND, STARTDATE, GETDATE()) ELSE DATEDIFF(SECOND, STARTDATE, ENDDATE) END AS SECOND_DIF
FROM dbo.Funcionario222
ORDER BY STATUS_FUNCIONARIO DESC;

------------------------------------------------------------------------------------------------------------------------------------

SELECT 
DepartmentName
,COUNT(DepartmentName) as 'Quantidade Total'
,CASE WHEN EndDate is null then '1 ' ELSE 'Desligado' END AS FUNC


FROM DBO.Funcionario222
WHERE CASE WHEN EndDate is null then '1 ' ELSE 'Desligado' END = 'Desligado'
GROUP BY 
DepartmentName, CASE WHEN EndDate is null then '1 ' ELSE 'Desligado' END 

--------------------------------------------------------------------------------------------------------------------------------------

SELECT 
Gender
,COUNT(Gender) as 'Quantidade Total'
,CASE WHEN EndDate is null then '1 ' ELSE 'Desligado' END AS FUNC


FROM DBO.Funcionario222
WHERE CASE WHEN EndDate is null then '1 ' ELSE 'Desligado' END = 'Desligado'
GROUP BY 
Gender, CASE WHEN EndDate is null then '1 ' ELSE 'Desligado' END 


